on: [push]

jobs:
  greet_log_job:
    runs-on: ubuntu-latest
    name: Log Main Event
    steps:
    - name: Log Step
      id: greet-log-step
      uses: napagroup/grape-ui-react/.github/actions/log-github@devops/41
      with:
        who-to-greet: 'User'
    - name: Time of log
      run: echo "The time was ${{ steps.greet.outputs.time }}"
  prod_build_job:
    runs-on: ubuntu-latest
    name: Build packages for prod repo
    env:
      SOURCE_REPO: napagroup/grape-ui-react
      MARKETING_REPO: napagroup/grape-ui-marketing
      MARKETING_REPO_PATH: grape-ui-marketing
    steps:
    - name: Setup Node.js environment
      uses: actions/setup-node@v1
      with:
        node-version: 12
    - name: Confirm node and env vars
      run: |
        node -v
        npm -v
        echo '$GITHUB_WORKSPACE' $GITHUB_WORKSPACE
        echo '$MARKETING_REPO' $MARKETING_REPO
        echo '$MARKETING_REPO_PATH' $MARKETING_REPO_PATH
        pwd
        ls -li
    - name: Checkout grape-ui-react repo
      uses: actions/checkout@v2
      with:
        repository: ${{ env.SOURCE_REPO }}
    - name: Confirm source checkout
      run: |
        pwd
        ls -li
    - name: Install and Build repo
      run: |
        # npm install
        # npm run build:styleguide
        pwd && ls -li
    - name: Checkout grape-ui-marketing repo
      uses: actions/checkout@v2
      with:
        repository: ${{ env.MARKETING_REPO }}
        path: ${{ env.MARKETING_REPO_PATH }}
    - name: Confirm grape-ui-marketing checkout
      run: |
        pwd && ls -li
        cd ${{ env.MARKETING_REPO_PATH }}
        pwd && ls -li
    - name: Test pwd
      run: |
        pwd && ls -li

